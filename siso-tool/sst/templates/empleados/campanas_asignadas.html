{% extends "base.html" %}
{% load static %}

{% block content %}
<div class="container mt-5">
  <h2 class="mb-4 text-center">游늶 Campa침as Asignadas</h2>

  {% if asignadas %}
    <div class="table-responsive">
      <table class="table table-bordered table-hover align-middle text-center shadow-sm">
        <thead class="table-primary">
          <tr>
            <th>Item</th>
            <th>C칩digo</th>
            <th>Nombre</th>
            <th>Detalle</th>
            <th>Estado</th>
            <th>Periodicidad</th>
            <th>Acci칩n</th>
          </tr>
        </thead>
        <tbody>
          {% for a in asignadas %}
          <tr>
            <td>{{ forloop.counter }}</td>

            <!-- C칩digo -->
            <td>{{ a.campa침a.codigo.codigo }}</td>

            <!-- Nombre -->
            <td>
              {% if a.campa침a.nombre %}
                {{ a.campa침a.nombre }}
              {% elif a.campa침a.codigo.nombre %}
                {{ a.campa침a.codigo.nombre }}
              {% else %}
                Sin nombre
              {% endif %}
            </td>

            <!-- Detalle -->
            <td>{{ a.campa침a.detalle|truncatewords:15|default_if_none:"Sin detalle" }}</td>

            <!-- Estado din치mico -->
            <td>
              {% if a.estado_actual == "finalizada" %}
                <span class="badge bg-danger">Finalizada</span>
              {% elif a.estado_actual == "pausada" %}
                <span class="badge bg-warning text-dark">Pausada</span>
              {% elif a.estado_actual == "activa" %}
                <span class="badge bg-success">Activa</span>
              {% else %}
                <span class="badge bg-secondary">{{ a.estado_actual|title }}</span>
              {% endif %}
            </td>

            <!-- Periodicidad -->
            <td>{{ a.campa침a.periodicidad|default:"-" }}</td>

            <!-- Acci칩n -->
            <td>
              {% if a.estado_actual == "finalizada" %}
                <a href="{% url 'detalle_campania_realizada' a.campa침a.id %}" 
                   class="btn btn-outline-success btn-sm">
                  游늹 Ver Evidencia
                </a>
              {% else %}
                <a href="{% url 'registrar_pausa' a.campa침a.id %}" 
                   class="btn btn-outline-primary btn-sm">
                  游 Registrar Pausa
                </a>
              {% endif %}
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>

    <!-- Bot칩n m치s peque침o para volver al Dashboard -->
    <div class="text-center mt-3">
      <a href="{% url 'dashboard_empleado' %}" class="btn btn-secondary btn-sm px-3">
        拘勇 Volver
      </a>
    </div>

  {% else %}
    <div class="alert alert-info text-center" role="alert">
      No tienes campa침as asignadas actualmente.
    </div>

    <div class="text-center mt-3">
      <a href="{% url 'dashboard_empleado' %}" class="btn btn-secondary btn-sm px-3">
        拘勇 Volver
      </a>
    </div>
  {% endif %}
</div>
{% endblock %}
